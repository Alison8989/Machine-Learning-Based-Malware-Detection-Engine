print "The story begins..."
import base64
import json
import urllib2
import requests

# id_and_key = 'hexAccountId_value:accountKey_value'
id_and_key = '' # NEED to fill
basic_auth_string = 'Basic ' + base64.b64encode(id_and_key)
headers = { 'Authorization': basic_auth_string }

request = urllib2.Request(
    'https://api.backblazeb2.com/b2api/v1/b2_authorize_account',
    headers = headers
    )
response = urllib2.urlopen(request)
response_data = json.loads(response.read())
response.close()

print 'auth token:', response_data['authorizationToken']
print 'api url:', response_data['apiUrl']
print 'download url:', response_data['downloadUrl']
print 'minimum part size:', response_data['minimumPartSize']

DOWNLOAD_URL = response_data['downloadUrl'] # Comes from b2_authorize_account
BUCKET_NAME = "" # The name of your bucket (not the ID)
ACCOUNT_AUTHORIZATION_TOKEN = response_data['authorizationToken'] # Comes from the b2_authorize_account call

fp = open('fileList.draft1')
for i, line in enumerate(fp.readlines()):
    # print i,line.strip()
    FILE_NAME = line.strip().split(" ")[2] # The name of the file in the bucket
    url = DOWNLOAD_URL + '/file/' + BUCKET_NAME + '/' + FILE_NAME
    # print urllib2.urlopen(url).read()
    print url

    headers = {
        'Authorization': ACCOUNT_AUTHORIZATION_TOKEN
        }

    response = requests.get(url)
    # request = urllib2.Request(url, None, headers)
    # response = urllib2.urlopen(request)
    file = open("bdsamples/" + FILE_NAME.split("/")[4], "w")
    file.write(response.content)
    file.close()

    #print response
    # response_data = json.loads(response.read())
    print
    response.close()

fp.close()
print "The story ends."
